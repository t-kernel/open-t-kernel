/*
 *----------------------------------------------------------------------
 *    T-Kernel 2.0 Software Package
 *
 *    Copyright 2011 by Ken Sakamura.
 *    This software is distributed under the latest version of T-License 2.x.
 *----------------------------------------------------------------------
 *
 *    Released by T-Engine Forum(http://www.t-engine.org/) at 2011/05/17.
 *    Modified by TRON Forum(http://www.tron.org/) at 2015/06/01.
 *
 *----------------------------------------------------------------------
 *    Open T-Kernel Project
 *    Copyright 2017 Du Huanpeng <u74147@gmail.com>
 *----------------------------------------------------------------------
 */

/*
 *	crtir.S
 *
 *	C startup
 *
 *	Relocatable module version
 *	_GLOBAL_OFFSET_TABLE_ is not used
 *	this means it is not Position Independent
 */

#ifdef __CC_ARM
; generated by Component: ARM Compiler 5.06 update 1 (build 61) Tool: armcc [4d35ad]
; commandline armcc [--arm --split_sections -S crtir-cpp.c]
        ARM
        REQUIRE8
        PRESERVE8

        AREA ||.fini||, CODE, READONLY, ALIGN=2

_fini PROC
        MOV     ip, sp                  // r3 is used to align stack
                                        // modulo 8 bytes
        STMDB   sp!, {r3-r9, sl, fp, ip, lr, pc}
        SUB     fp, ip, #4

        ENDP


        AREA ||.init||, CODE, READONLY, ALIGN=2

_init PROC
        MOV     ip, sp                  // r3 is used to align stack
                                        // modulo 8 bytes
        STMDB   sp!, {r3-r9, sl, fp, ip, lr, pc}
        SUB     fp, ip, #4
        ENDP


        EXPORT _fini [CODE]
        EXPORT _init [CODE]

        END
#endif
